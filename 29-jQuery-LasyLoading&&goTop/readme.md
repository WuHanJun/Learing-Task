## 回到顶部

- 开写

先看goTop,本来一想，无非就是在这个btn上面绑定两个事件，用`$(window).scrollTop()`确定位置，
都不用算到某个点的offset().top和`$(window).scrollTop()`。直接show()就好了。
不过真要写起来还是有几个点注意一下。

1. 在js里创建该节点，css里设置样式，并默认dispaly:none
2. 第一次下拉创建该节点并设置data-exist[下次根据此判断就不用创建节点，直接hide()和show()]
3. 获取当前位置的scrollTop要写在监听函数里面呀，刚做的时候被这个蒙了一会儿。后来才发现，写在外面和里面当然有很大区别。
- 写完之后开始升级
1. 直接将函数扔到一个GoTop对象里，优点：直接调用便利。直接加载xxx.js，然后调用GoTop.init里的函数就行了。缺点：变量在控制台会被别人看见，不安全
2. 需要注意的是this的用法，虽然还没好好看过this,但这里的还是能看懂。
3. 扔到一个对象里其实可以分好几块，这个例子就是获取数据一块，处理数据一块。

- 再升级

1. 这就用了闭包的写法，外层函数返回的是内部的一个函数，这样写比较正统，安全性较高，在控制台看到的只是函数名。
![](leanote://file/getImage?fileId=586775428aed3b516b000000)
```
疑惑：怎么样能够加快debug的速度呢，总是一会懵逼，一会突然清醒了就去找位置console。效率低下。
```
## 懒加载

一开始想的是到某个点然后将data-img中存储的链接放到src里面，但是怎么判断每个图片是否出现在窗口中呢？看了大神的才知道，用个`$(selector).each()`就行了。自身也是知道这个函数的，怎么想不到呢？归根结底都是基础不够牢固，学的时间太短。希望能够在实践中多吸收。

- 三个点：

1. 刚载入页面时，直接执行checkshow()函数，让第一批图片先展示出来。
2. 设置延时，防止用户下拉时，一直加载过程中的图片，浪费网络资源。
3. 核心：用户下拉停止后检测图片是否有isshow属性。（这是为了防止已经加载过的图片再次执行后面的步骤）如果没有，遍历所有图片(除了刚刚剔除的那些)看它们的位置关系是否满足条件来看是否在窗口中决定是否将data-img中的链接给src。
```
再总结：监听函数 || checkShow() || isShow($ele) || showImg($ele)
```

## 加载更多

1. 监听函数内设置延时器防止按钮出现后滚动过程中一直加载。
2. `isVisible($ele)`查看按钮是否可见。
3. `load()`发送数据，注意dataType是返回数据的类型。没有自己用原生js实现过，总感觉很迷糊，在学ajax mock数据的时候也是用的jquery直接做的。

```
对mocck数据这块比较虚。
```
